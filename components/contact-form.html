<link rel="stylesheet" href="./assets/css/contact-form.css" />
<div class="contact-form">
    <div class="container">
        <div class="contact-form-inner">
            <div class="form-left">
                <h2>聯絡資訊</h2>
                <div class="form-item-list">
                    <div class="form-item">
                        <div><i class="fas fa-map-marker-alt"></i></div>
                        <div class="form-item-title">地址</div>
                        <div class="form-item-text">台中市-北屯區北屯路366號7F-1</div>
                    </div>
                    <div class="form-item">
                        <div><i class="fas fa-phone"></i></div>
                        <div class="form-item-title">電話</div>
                        <div class="form-item-text">04-2243-4288</div>
                    </div>
                    <div class="form-item">
                        <div><i class="fas fa-envelope"></i></div>
                        <div class="form-item-title">電子郵件</div>
                        <div class="form-item-text">service@lovetech.tw</div>
                    </div>
                </div>
            </div>
            <div class="form-right">
                <h2>發送訊息</h2>
                <form
                    action=""
                    class="form-wrap"
                    id="contactForm"
                    onsubmit="return handleFormSubmit(event)"
                >
                    <div class="form-item">
                        <label for="contact-form-name">姓名</label>
                        <input
                            type="text"
                            id="contact-form-name"
                            name="name"
                            placeholder="請輸入姓名"
                        />
                    </div>
                    <div class="form-item">
                        <label for="contact-form-email">電子郵件</label>
                        <input
                            type="text"
                            id="contact-form-email"
                            name="email"
                            placeholder="請輸入電子郵件"
                        />
                    </div>
                    <div class="form-item">
                        <label for="contact-form-subject">主旨</label>
                        <input
                            type="text"
                            id="contact-form-subject"
                            name="subject"
                            placeholder="請輸入主旨"
                        />
                    </div>
                    <div class="form-item">
                        <label for="contact-form-message">訊息內容</label>
                        <textarea
                            id="contact-form-message"
                            name="message"
                            placeholder="請輸入訊息內容"
                        ></textarea>
                    </div>
                    <button type="submit" class="form-submit-btn">送出訊息</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function handleFormSubmit(event) {
        event.preventDefault();

        const form = document.getElementById('contactForm');
        const formData = new FormData(form);
        const data = Object.fromEntries(formData);

        // 替換成您的 Google Apps Script 網址
        const scriptURL = 'YOUR_GOOGLE_APPS_SCRIPT_URL';

        fetch(scriptURL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then(response => {
                if (response.ok) {
                    alert('訊息已成功送出！');
                    form.reset();
                } else {
                    throw new Error('送出失敗');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('發生錯誤，請稍後再試。');
            });

        return false;
    }
</script>
